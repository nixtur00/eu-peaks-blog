---
// Enhanced Navigation component with improved UX
---

<nav class="bg-white dark:bg-mountain-900 border-b border-mountain-200 dark:border-mountain-700 shadow-sm sticky top-0 z-50">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 justify-between items-center">
      <!-- Logo/Brand -->
      <div class="flex items-center">
        <a href="/" class="flex items-center space-x-2 group">
          <svg class="w-8 h-8 text-mountain-700 dark:text-mountain-300" fill="currentColor" viewBox="0 0 24 24">
            <path d="M2.5 19h19l-9.5-15.5L2.5 19zM12 8.5L6.5 17h11L12 8.5z"/>
            <path d="M1 21h22L12 2 1 21zm3.5-2h15L12 6.5 4.5 19z"/>
          </svg>
          <span class="text-xl font-bold bg-gradient-to-r from-mountain-900 to-mountain-700 dark:from-mountain-100 dark:to-mountain-300 bg-clip-text text-transparent">
            27 Before 27
          </span>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-8">
        <a
          href="/"
          class="nav-link"
          data-page="home"
        >
          <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
          </svg>
          Home
        </a>
        <a
          href="/peaks"
          class="nav-link"
          data-page="peaks"
        >
          <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3l5.586 5.586a2 2 0 002.828 0L19 3"></path>
          </svg>
          Adventure Log
        </a>
        <a
          href="/about"
          class="nav-link"
          data-page="about"
        >
          <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          About
        </a>
        
        <!-- Admin/Development Links -->
        <div class="admin-only hidden">
          <a
            href="/new-post"
            class="btn-primary text-sm"
          >
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            New Adventure
          </a>
        </div>
        
        <!-- Theme Toggle -->
        <button
          id="theme-toggle"
          class="p-2 rounded-lg text-mountain-600 dark:text-mountain-400 hover:bg-mountain-100 dark:hover:bg-mountain-800 transition-colors"
          aria-label="Toggle theme"
        >
          <svg id="theme-toggle-dark-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
          </svg>
          <svg id="theme-toggle-light-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
          </svg>
        </button>
      </div>

      <!-- Mobile menu button -->
      <div class="md:hidden">
        <button
          id="mobile-menu-button"
          class="p-2 rounded-lg text-mountain-600 dark:text-mountain-400 hover:bg-mountain-100 dark:hover:bg-mountain-800 transition-colors"
          aria-label="Toggle menu"
        >
          <svg id="mobile-menu-open" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg id="mobile-menu-close" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Navigation Menu -->
    <div id="mobile-menu" class="md:hidden hidden border-t border-mountain-200 dark:border-mountain-700 py-4">
      <div class="space-y-3">
        <a
          href="/"
          class="mobile-nav-link"
          data-page="home"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
          </svg>
          Home
        </a>
        <a
          href="/peaks"
          class="mobile-nav-link"
          data-page="peaks"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3l5.586 5.586a2 2 0 002.828 0L19 3"></path>
          </svg>
          Adventure Log
        </a>
        <a
          href="/about"
          class="mobile-nav-link"
          data-page="about"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          About
        </a>
        
        <!-- Mobile Admin Links -->
        <div class="admin-only hidden pt-3 border-t border-mountain-200 dark:border-mountain-700">
          <a
            href="/new-post"
            class="mobile-nav-link text-summit-600 dark:text-summit-400"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            New Adventure
          </a>
        </div>
        
        <!-- Mobile Theme Toggle -->
        <div class="pt-3 border-t border-mountain-200 dark:border-mountain-700">
          <button
            id="mobile-theme-toggle"
            class="mobile-nav-link w-full text-left"
          >
            <svg id="mobile-theme-dark-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
              <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
            </svg>
            <svg id="mobile-theme-light-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
            </svg>
            <span id="mobile-theme-text">Toggle Theme</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>

<style>
  .nav-link {
    @apply flex items-center text-mountain-700 dark:text-mountain-300 hover:text-summit-600 dark:hover:text-summit-400 transition-colors duration-200 font-medium;
  }
  
  .nav-link.active {
    @apply text-summit-600 dark:text-summit-400;
  }
  
  .mobile-nav-link {
    @apply flex items-center space-x-3 text-mountain-700 dark:text-mountain-300 hover:text-summit-600 dark:hover:text-summit-400 transition-colors duration-200 font-medium py-2 px-3 rounded-lg hover:bg-mountain-50 dark:hover:bg-mountain-800;
  }
  
  .mobile-nav-link.active {
    @apply text-summit-600 dark:text-summit-400 bg-summit-50 dark:bg-summit-900/20;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Show admin elements only on localhost development
    const isAdmin =
      window.location.hostname === 'localhost' ||
      window.location.hostname === '127.0.0.1' ||
      window.location.search.includes('admin=true');

    if (isAdmin) {
      const adminElements = document.querySelectorAll('.admin-only');
      adminElements.forEach(el => {
        el.classList.remove('hidden');
      });
    }

    // Mobile menu toggle
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileMenuOpen = document.getElementById('mobile-menu-open');
    const mobileMenuClose = document.getElementById('mobile-menu-close');

    if (mobileMenuButton && mobileMenu) {
      mobileMenuButton.addEventListener('click', () => {
        const isHidden = mobileMenu.classList.contains('hidden');
        
        if (isHidden) {
          mobileMenu.classList.remove('hidden');
          mobileMenuOpen?.classList.add('hidden');
          mobileMenuClose?.classList.remove('hidden');
        } else {
          mobileMenu.classList.add('hidden');
          mobileMenuOpen?.classList.remove('hidden');
          mobileMenuClose?.classList.add('hidden');
        }
      });
    }

    // Set active navigation state
    function setActiveNav() {
      const currentPath = window.location.pathname;
      const navLinks = document.querySelectorAll('[data-page]');
      
      navLinks.forEach(link => {
        const page = link.getAttribute('data-page');
        link.classList.remove('active');
        
        if (
          (page === 'home' && currentPath === '/') ||
          (page === 'peaks' && currentPath.startsWith('/peaks')) ||
          (page === 'about' && currentPath.startsWith('/about'))
        ) {
          link.classList.add('active');
        }
      });
    }

    // Theme toggle functionality
    function initThemeToggle() {
      const themeToggle = document.getElementById('theme-toggle');
      const mobileThemeToggle = document.getElementById('mobile-theme-toggle');
      const darkIcon = document.getElementById('theme-toggle-dark-icon');
      const lightIcon = document.getElementById('theme-toggle-light-icon');
      const mobileDarkIcon = document.getElementById('mobile-theme-dark-icon');
      const mobileLightIcon = document.getElementById('mobile-theme-light-icon');
      const mobileThemeText = document.getElementById('mobile-theme-text');

      function updateThemeIcons() {
        const isDark = document.documentElement.classList.contains('dark');
        
        if (isDark) {
          darkIcon?.classList.add('hidden');
          lightIcon?.classList.remove('hidden');
          mobileDarkIcon?.classList.add('hidden');
          mobileLightIcon?.classList.remove('hidden');
          if (mobileThemeText) mobileThemeText.textContent = 'Light Mode';
        } else {
          darkIcon?.classList.remove('hidden');
          lightIcon?.classList.add('hidden');
          mobileDarkIcon?.classList.remove('hidden');
          mobileLightIcon?.classList.add('hidden');
          if (mobileThemeText) mobileThemeText.textContent = 'Dark Mode';
        }
      }

      function toggleTheme() {
        const isDark = document.documentElement.classList.contains('dark');
        
        if (isDark) {
          document.documentElement.classList.remove('dark');
          localStorage.setItem('theme', 'light');
        } else {
          document.documentElement.classList.add('dark');
          localStorage.setItem('theme', 'dark');
        }
        
        updateThemeIcons();
      }

      // Set initial theme
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      
      if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
        document.documentElement.classList.add('dark');
      }
      
      updateThemeIcons();

      // Add event listeners
      themeToggle?.addEventListener('click', toggleTheme);
      mobileThemeToggle?.addEventListener('click', toggleTheme);
    }

    // Initialize
    setActiveNav();
    initThemeToggle();
  });
</script>
